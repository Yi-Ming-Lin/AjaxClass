
@{
    ViewData["Title"] = "JsonRead";
}

<h1>JsonRead</h1>
<div id="div1"></div>
@section Scripts{

    <script>
        var dataUrl = "https://data.tycg.gov.tw/api/v1/rest/datastore/bd906b29-9006-40ed-8bd7-67597c2577fc?format=json"
        var xhr = new XMLHttpRequest();
        xhr.addEventListener("loadstart",()=>{
            $("#div1").append("<pp>")
        })
        xhr.addEventListener("load",function(){
            var card = "";
            var x = JSON.parse(xhr.responseText)
            x.result.records.forEach(f => {
                card += `
                                                <div class="card mt-3">
                                                          <div class="card-header">${f.Add}</div>
                                                  <div class="card-body">
                                                            <h5 class="card-title">${f.Name}</h5>
                                                    <p class="card-text">
                                                              ${f.Toldescribe}
                                                            </p>
                                                   <p class="card-text">
                                                                       開放時間: ${f.Opentime}
                                                     </p>
                                                    <p class="card-text">
                                                                         是否收費: ${f.Ticketinfo}
                                                     </p>
                                                            <a href="${f.TYWebsite}" class="btn btn-primary">深入了解</a>
                                                  </div>
                                                </div>
                                                `;
            })
            $("#div1").append(card);
        })
        xhr.open("Get", dataUrl);
        xhr.send();
        //$.ajax({
        //    url: dataUrl,
        //    method: 'GET',
        //    dataType: 'json',
        //    data: '',
        //    async: true,

        //    success: x => {
        //        var card = "";
        //        x.result.records.forEach(f=>{
        //            card += `
        //                                <div class="card mt-3">
        //                                          <div class="card-header">${f.Add}</div>
        //                                  <div class="card-body">
        //                                            <h5 class="card-title">${f.Name}</h5>
        //                                    <p class="card-text">
        //                                              ${f.Toldescribe}
        //                                            </p>
        //                                   <p class="card-text">
        //                                                       開放時間: ${f.Opentime}
        //                                     </p>
        //                                    <p class="card-text">
        //                                                         是否收費: ${f.Ticketinfo}
        //                                     </p>
        //                                            <a href="${f.TYWebsite}" class="btn btn-primary">深入了解</a>
        //                                  </div>
        //                                </div>
        //                                `;
        //        })
        //        $("#div1").append(card);
        //    },
        //    error: err => {
        //        console.log(err)
        //    },
        //});

   </script>
}
